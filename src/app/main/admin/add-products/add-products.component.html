<div class="container">
  <h1 class="primary__heading">Add product</h1>
  <form [formGroup]="productForm" (ngSubmit)="onSubmit()">
    <div class="row">
      <div class="col-md-8">
       <mat-card>

        <mat-form-field class="form_field" appearance="outline">
          <mat-label>Title</mat-label>
          <input matInput placeholder="e.g. T-shirt" formControlName="title">
          <mat-error 
          *ngIf="submitted && productForm.get('title').hasError('required')"
          >Title is required !</mat-error>
        </mat-form-field>

        <mat-form-field class="form_field" appearance="outline">
          <mat-label>Description</mat-label>
          <textarea matInput rows="4"  formControlName="description"></textarea>
          <mat-error 
          *ngIf="submitted && productForm.get('description').hasError('required')"
          >Description is required !</mat-error>
        </mat-form-field>

       </mat-card>
        
       <mat-card class="my-3">
         <h3>Media</h3>
         <div class="product_imgs">
           <img src="../../../../assets/img/default_img.png" alt="default_igm" height="200px" width="100%" *ngIf="imgPreview.length===0">
  
           <div *ngIf="imgPreview && imgPreview.length!==0">
            <div  class="d-flex">
              <div class="previewImg" *ngFor="let img of imgPreview; let i=index">
                <img [src]="img" alt="default_igm" height="100%" width="100%" >
                <mat-icon class="img_delete" (click)="onDeleteImg(i)">highlight_off</mat-icon>
              </div>
            </div>
           </div>
         </div>
      
        <div class="d-flex mt-3">
          <div style="flex: 1 1 auto;">
            <strong>NOTE:</strong>
            <span>You can select maximum 3 images !</span>
          </div>
          <div>
            <button mat-flat-button color="primary" 
            (click)="productImg.click()"
             [disabled]="imgPreview.length>=3"
             type="button">
              <mat-icon>add_photo_alternate</mat-icon>
              Add Product
            </button>
          </div>
          </div>

       <input type="file" style="display: none;" (change)="onSelect($event)" #productImg >
       <mat-error 
       *ngIf="productForm.get('images').hasError('maxLength')"
       >Max images is 4!
     </mat-error>
     <mat-error 
       *ngIf="submitted && productForm.get('images').hasError('required')"
       >Image is  required !
     </mat-error>
       </mat-card>
        
        <!-- card3 -->
     <mat-card>
       <h3>Pricing</h3>
       <div class="row">
         <div class="col-lg-6">
          <mat-form-field class="form_field" appearance="outline">
            <mat-label>MRP Price</mat-label>
            <input matInput placeholder="Rs.0.00" type="number"  formControlName="mrp">
            <mat-error 
          *ngIf="submitted && productForm.get('mrp').hasError('required')"
          >MRP is required !</mat-error>
          </mat-form-field>
         </div>
         <div class="col-lg-6">
          <mat-form-field class="form_field" appearance="outline">
            <mat-label>Selling Price</mat-label>
            <input matInput placeholder="Rs.0.00" type="number"  formControlName="price">
            <mat-error 
          *ngIf="submitted && productForm.get('price').hasError('required')"
          >Price is required !</mat-error>
          </mat-form-field>
         </div>
       </div>
  
       <div class="row">
        <div class="col-lg-6">
          <mat-form-field class="form_field" appearance="outline">
            <mat-label>Shipping Charge</mat-label>
            <input matInput placeholder="Rs.0.00" type="number"  formControlName="shippingCharge">
            <mat-error 
            *ngIf="submitted && productForm.get('shippingCharge').hasError('required')"
            >Shipping price is required !</mat-error>
          </mat-form-field>
        </div>
        <div class="col-lg-6">
          <mat-form-field class="form_field" appearance="outline">
            <mat-label>Tax per Item</mat-label>
            <input matInput placeholder="Rs.0.00" type="number"  formControlName="tax">
          </mat-form-field>
        </div>
      </div>
  
     </mat-card>
  
        <div class="variant-card mt-3">
          <mat-card>
            <h3>Quantity</h3>
            <div class="row">
              <div class="col-lg-4">
                <mat-form-field class="form_field" appearance="outline">
                  <mat-label>Available</mat-label>
                  <input matInput placeholder="Rs.0.00" type="number"  formControlName="quantity">
                  <mat-error 
                  *ngIf="submitted && productForm.get('quantity').hasError('required')"
                  >Quantity is required !
                </mat-error>
                </mat-form-field>
              </div>
              <div class="col-lg-8"></div>
            </div>
          
            <h3>Variants</h3>
             <div class="row">
               <div class="col-lg-4" formArrayName="propertyName">
                <mat-form-field
                class="form_field" 
                appearance="outline"
                *ngFor="let name of productForm.get('propertyName')['controls']; let i=index">
                  <input matInput placeholder="e.g. Color,Size etc." type="text" [formControlName]="i">
                </mat-form-field>
               </div>
               
               <div class="col-lg-8" formArrayName="valueName">
               <div *ngFor="let value of productForm.get('valueName')['controls']; let i=index"
               style="flex: 1 1 auto;flex-direction: row;align-items: center; " 
               class="d-flex">
                <mat-form-field
                class="form_field "
                appearance="outline"
                >
                  <input matInput placeholder="e.g. Red,M etc." type="text" [formControlName]="i" >
                </mat-form-field>
                <div class="ml-2 mb-3">
                  <button mat-mini-fab (click)="OnRemoveVariants(i)" type="button" >
                    <mat-icon>delete</mat-icon>
                  </button>
                </div>
               </div>
               </div>
              
             </div>
             <div class="d-flex mt-2" style="justify-content: flex-end;">
              <button mat-flat-button color="primary" class="ml-3" (click)="onAddVariants()" type="button">
                <mat-icon>add</mat-icon> Add
              </button>
            </div>
           
          </mat-card>
        </div>
      </div>
  
  
  
      <div class="col-md-4 mt-3 mt-md-0">
        <mat-card>
          <h3>Organization</h3>
          <mat-form-field class="form_field" appearance="outline">
            <mat-label>Vendor</mat-label>
            <input matInput placeholder="e.g. Nike" type="text" formControlName="vendor">
            <mat-error 
                  *ngIf="submitted && productForm.get('quantity').hasError('required')"
                  >Quantity is required !
                </mat-error>
          </mat-form-field>
          <mat-form-field class="form_field" appearance="outline">
            <mat-label>Collections</mat-label>
            <input matInput placeholder="e.g. Shirt" type="text" formControlName="collections">
            <mat-icon matSuffix>search</mat-icon>
          </mat-form-field>
          <mat-form-field class="form_field" appearance="outline">
            <mat-label>Tags</mat-label>
            <input matInput placeholder="e.g. Vintage,Cotton,Summer" type="text" formControlName="tags">
          </mat-form-field>
        </mat-card>
      </div>
    </div>
    <div class="mt-3">
      <button mat-raised-button color="primary" type="submit" >Save</button>
    </div>
  </form>

</div>

<mat-spinner class="spinner" *ngIf="isLoading"></mat-spinner>